#include "DataSet.hpp"
#include <vector>
#include <cmath>
#include <random>

using namespace std;


// Constructors 
DataSet::DataSet():m_inputDimension(0), m_samples(0)
{}

DataSet::DataSet(size_t inputDimension): m_inputDimension(inputDimension), m_samples(0)
{}

DataSet::DataSet(Perceptron &perceptron)
{
    vector<Dendrite> dendrites = perceptron.getDendrites();
    m_inputDimension = size(dendrites);
    
}

// Setters

void DataSet::setInputDimension(size_t inputDimension)
{
    m_inputDimension = inputDimension;
}

void DataSet::addSample(vector<double>& input, double output)
{
    m_samples.emplace_back(input, output);
}


// Getters

size_t DataSet::getInputDimension() const
{
    return m_inputDimension;
}

const vector<DataSample>& DataSet::getSamples() const
{
    return m_samples;
}

// Oth
void DataSet::genereDiscDataset(size_t nSamples,
                                double xc, double yc,
                                double radius,
                                double output)
{
    // Générateur aléatoire
    static std::random_device rd;
    static std::mt19937 gen(rd());
    std::uniform_real_distribution<double> distAngle(0.0, 2.0 * M_PI);
    std::uniform_real_distribution<double> distRadius(0.0, 1.0);

    for (size_t i = 0; i < nSamples; ++i)
    {
        double theta = distAngle(gen);
        double u = distRadius(gen);

        // Rayon distribué uniformément
        double r = radius * std::sqrt(u);

        double x = xc + r * std::cos(theta);
        double y = yc + r * std::sin(theta);

        vector<double> input = { x, y };
        addSample(input, output);
    }
}
