#pragma once

#include <vector>
#include "Dendrite.hpp"
#include "DataSet.hpp"

class Perceptron {
public:
    explicit Perceptron(double biais = 0.0);

    // Setters
    void addInput(Perceptron& input, double weight);


    // Getters
    const std::vector<double>& getOutput() const;
    const std::vector<Dendrite>& getDendrites() const;


    // Other

    const double calcInput(const DataSample &datasample) const;


    void compute(const DataSample& datasample);
    double calcLogLoss(const DataSet &dataSet) const;
    double calcGradient(const DataSet &dataSet) const;
    void stepGradientDescent(DataSet &dataSet);
    const std::vector<double> activation(std::vector<double> &z) const;

private:
    double m_biais;
    double m_output;  // Dimension = nbre de DataSample dans le dataSet en entrée
    double m_learningStep;
    std::vector<Dendrite> m_dendrites; //Dimension : Dimension des DataSample du DataSet en entrée (nb de neurones dans la couche précédente)
};
